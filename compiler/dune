(library
 (name compile_lib)
 (public_name MiniML.compile)
 (libraries stdio miniml cconv)
 (modules ANF ANF2 compile_tests)
 (preprocess
  (pps
   ; ppx_blob
   ppx_expect
   ;
   ))
 (inline_tests))

(library
 (public_name MiniML.cconv)
 (name cconv)
 (libraries miniml)
 (modules CConv monads)
 (wrapped false)
 (preprocess
  (pps
   ; ppx_blob
   ppx_expect
   ;
   ))
 (inline_tests))

(executable
 (name compiler)
 (modules compiler)
 (libraries stdio base miniml compile_lib))

(cram
 ;(enabled_if
 ; (= true %{env:RUN_MY_TEST=false}))
 (deps ../REPL.exe ./compiler.exe))
